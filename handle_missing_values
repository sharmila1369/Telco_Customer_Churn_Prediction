from sklearn.impute import SimpleImputer, KNNImputer
import numpy as np

def handle_missing_values(self):
    try:
        self.logger.info("Handling missing values...")

         Replace blanks (" ") with NaN
        self.df.replace(" ", np.nan, inplace=True)

          Convert numeric columns to proper type (for TotalCharges)
        if 'TotalCharges' in self.df.columns:
            self.df["TotalCharges"] = pd.to_numeric(self.df["TotalCharges"], errors="coerce")

          Numeric Columns - handle missing using Median
        num_cols = self.df.select_dtypes(include=np.number).columns
        num_imputer = SimpleImputer(strategy='median')
        self.df[num_cols] = num_imputer.fit_transform(self.df[num_cols])

         Categorical Columns - handle missing using Most Frequent
        cat_cols = self.df.select_dtypes(include='object').columns
        cat_imputer = SimpleImputer(strategy='most_frequent')
        self.df[cat_cols] = cat_imputer.fit_transform(self.df[cat_cols])

          Alternative (more advanced) methods you can try:
         KNN Imputer for numeric
         knn = KNNImputer(n_neighbors=3)
         self.df[num_cols] = knn.fit_transform(self.df[num_cols])

         Iterative Imputer for correlated numeric columns
         from sklearn.experimental import enable_iterative_imputer
         from sklearn.impute import IterativeImputer
         iterative = IterativeImputer(random_state=42)
         self.df[num_cols] = iterative.fit_transform(self.df[num_cols])

        self.logger.info(" Missing values handled successfully!")

    except Exception as e:
        self.logger.error(f" Error handling missing values: {e}")
